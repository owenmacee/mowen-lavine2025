---
title: "Pathway enrichment"
author: "Macee Owen"
output: html_document
---

# Load relevant libraries
```{r}
library(Seurat)
library(ggplot2)
library(patchwork)
library(dplyr)
library(hdf5r)
library(harmony)
library(SPOTlight)
library(SeuratData)
library(SeuratDisk)
library(enrichplot)
library(enrichR)
library(Matrix)
library(data.table)
library(gt)
library(igraph)
library(RColorBrewer)
library(VennDiagram)
library(viridis)
library(spacexr)
```

# Modulated SMC gene pathway enrichment plot
```{r}
modCtrl <- read.delim("C:/Users/15207/Desktop/new CAV/modSMCCtrltable.txt")
# Enrichment plot
png(filename="./modCtrlpathway.png", width=40, height=40, units="cm", res=300)
plotEnrich(modCtrl, showTerms = 10, numChar = 40, y = "Count", orderBy = "P.value", title = "Ctrl Modulated SMC Pathway Enrichment")
dev.off()
```

# Dot plot
```{r}
modCtrl$genecount <- (lengths(gregexpr(";",modCtrl$Genes))+1)

png(filename = "./modCtrl5pathwaydot.png", width=25, height=20, units="cm", res=300)
ggplot()+
  geom_point(data=head(modCtrl, 5), aes(x= Combined.Score, y=reorder(Term, Combined.Score), colour = P.value, size = genecount)) + 
  scale_colour_gradient(low= "blue", high = "red")+
  theme_bw()
dev.off()
```

# Ontology
```{r}
ModSMContology <- read.delim("C:/Users/15207/Desktop/new CAV/GOontologyModSMCtable.txt")

plotEnrich(modSMCpath, showTerms = 15, numChar = 40, y = "Count", orderBy = "Adjusted.P.value", title = "Modulated SMC Enrichment Analysis")
```


